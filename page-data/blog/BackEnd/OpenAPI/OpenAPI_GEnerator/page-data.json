{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/BackEnd/OpenAPI/OpenAPI_GEnerator/",
    "result": {"data":{"site":{"siteMetadata":{"title":"おっさんWEBエンジニア奮闘記"}},"markdownRemark":{"id":"4a0342d3-56ac-59bb-ab95-f2b0e92ff1b2","excerpt":"openapi generator OPENAPI の yml から Format を生成。 から openapi.json を生成。 生成された openapi.json (openapi.yaml でも可)を Prism(mock server)に読み込ませる。 により yaml…","html":"<h2>openapi generator</h2>\n<p><strong>OPENAPI</strong> の yml から Format を生成。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">openapi-generator-cli generate -g openapi -i src/root.yml -o generated/openapi\n<span class=\"token comment\"># -g &lt;formatName></span></code></pre></div>\n<p><code class=\"language-text\">src/root.yml</code>から openapi.json を生成。<br>\n生成された openapi.json (openapi.yaml でも可)を Prism(mock server)に読み込ませる。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> run <span class=\"token function\">watch</span></code></pre></div>\n<p>により yaml の変更を追従し再生成。</p>\n<p><a href=\"https://openapi-generator.tech/docs/generators/\">Generators List</a></p>\n<h3>Dockerfile</h3>\n<p><strong>Require JAVA</strong>\njava ベースの DockerImage のため別途 <code class=\"language-text\">node</code> <code class=\"language-text\">npm</code> を別途インストール</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">FROM openjdk<span class=\"token punctuation\">:</span>11<span class=\"token punctuation\">-</span>slim\n\nRUN apt<span class=\"token punctuation\">-</span>get <span class=\"token punctuation\">-</span>y update\nRUN apt<span class=\"token punctuation\">-</span>get <span class=\"token punctuation\">-</span>y install nodejs\nRUN apt<span class=\"token punctuation\">-</span>get <span class=\"token punctuation\">-</span>y install npm\n\n  <span class=\"token comment\"># 環境変数がないとErrorになる</span>\nENV SHELL /bin/sh\n\nWORKDIR /app\n\nCOPY package.json ./\nRUN npm install</code></pre></div>\n<h3>package.json</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"structured-openapi-schema\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"generate:schema_json\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"schema_json\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"generate:schema_yaml\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"schema_yaml\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"generated:schema_markdown\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"schema_markdown\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"generated:schema_html2\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"schema_html2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"schema_json\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"openapi-generator-cli generate -g openapi -i src/root.yml -o generated/openapi\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"schema_yaml\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"openapi-generator-cli generate -g openapi-yaml -i src/root.yml -o generated\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"schema_markdown\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"openapi-generator-cli generate -g markdown -i src/root.yml -o generated/markdown\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"schema_html\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"openapi-generator-cli generate -g html -i src/root.yml -o generated/html\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"schema_html2\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"openapi-generator-cli generate -g html2 -i src/root.yml -o generated/html2\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"schema_dynamic-html\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"openapi-generator-cli generate -g dynamic-html -i src/root.yml -o generated/dynamic_html\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"schema_plantuml\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"openapi-generator-cli generate -g plantuml -i src/root.yml -o generated/plantuml\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"generate\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm-run-all -s generate:*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"clean\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rimraf generated/*\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"npm-run-all -s clean generate\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"watch\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"chokidar 'src/root.yml' 'src/**/*.yml' -c 'npm run schema_yaml' --initial\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"devDependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"@openapitools/openapi-generator-cli\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^2.4.18\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"chokidar-cli\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^3.0.0\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"npm-run-all\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^4.1.5\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"rimraf\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"^3.0.2\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">npm run watch</code> で</p>\n<ul>\n<li>openapi.json</li>\n<li>openapi.yaml</li>\n<li>markdown</li>\n</ul>\n<p>を生成するように設定。<br>\n他の `dynamic-html’ を生成する場合は</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">docker-compose</span> <span class=\"token builtin class-name\">exec</span> openapi <span class=\"token function\">npm</span> run schema_dynamic-html</code></pre></div>\n<h2>prim</h2>\n<p>上記で生成された <code class=\"language-text\">openapi.json</code> (openapi.yaml でも可)から mock server を起動。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># -d によりデータを自動生成</span>\n<span class=\"token string\">'mock -h 0.0.0.0 -d ${path_for_yaml_or_json}'</span></code></pre></div>\n<h3>dockerfile</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">FROM stoplight/prism</code></pre></div>\n<h2>Docker-compose</h2>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">prism</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> ./docker/prism\n  <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>PRISM_CONTAINER_NAME<span class=\"token punctuation\">}</span>\n  <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"mock -h 0.0.0.0 -d /app/dist.json\"</span>\n  <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>DIR<span class=\"token punctuation\">}</span>/dist/dist.json<span class=\"token punctuation\">:</span>/app/dist.json\n  <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token string\">\"${PRISM_CLIENT_PORT}:4010\"</span>\n\n<span class=\"token key atrule\">openapi</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span> ./docker/openapi\n  <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> openapi\n  <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>DIR<span class=\"token punctuation\">}</span>/generated<span class=\"token punctuation\">:</span>/app/generated\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>DIR<span class=\"token punctuation\">}</span>/src<span class=\"token punctuation\">:</span>/app/src\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>DIR<span class=\"token punctuation\">}</span>/docker/openapi/package.json<span class=\"token punctuation\">:</span>/app/package.json\n  <span class=\"token key atrule\">tty</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>","frontmatter":{"title":"OpenAPI-Generatorの環境をDockerで構築","date":"February 23, 2022","post_modified":"February 23, 2022","description":"","tags":["API","OpenAPI","Prism","Docker","Docker-compose"],"draft":false}},"previous":{"fields":{"slug":"/BackEnd/OpenAPI_basic/"},"frontmatter":{"title":"OpenAPI の基本知識"}},"next":{"fields":{"slug":"/BackEnd/API/RestAPI/"},"frontmatter":{"title":"REST API"}}},"pageContext":{"id":"4a0342d3-56ac-59bb-ab95-f2b0e92ff1b2","previousPostId":"3258e002-0e2a-5dbd-970b-81dd9dbd0fe2","nextPostId":"2ad026f3-2291-5de9-a2f0-0a4b7b193970","draft":false}},
    "staticQueryHashes": ["1126706167","1176493165","1188992244","1314910092","1760060771","2772418575","3679674316"]}