{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/BackEnd/DB/Transaction/",
    "result": {"data":{"site":{"siteMetadata":{"title":"おっさんWEBエンジニア奮闘記"}},"markdownRemark":{"id":"3ab79d42-7cb1-5a5c-be5f-167e44eef412","excerpt":"Example 分離レベル デフォルトは READCOMMITTED 分離レベル ダーティーリード 反復不能読み取り ファントムリード READ UNCOMMITTED 恐れアリ 恐れアリ 恐れアリ READ COMMITTED 発生しない 恐れアリ 恐れアリ REPEATABlLE READ…","html":"<h2>Example</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">BEGIN</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> 家計簿アーカイブ\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> 家計簿 <span class=\"token keyword\">WHERE</span> 日付 <span class=\"token operator\">&lt;=</span> <span class=\"token string\">'2018-01-31'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">DELETE</span> <span class=\"token keyword\">FROM</span> 家計簿 <span class=\"token keyword\">WHERE</span> 日付 <span class=\"token operator\">&lt;=</span> <span class=\"token string\">'2018-01-31'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">COMMIT</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>分離レベル</h2>\n<p><strong>デフォルトは READCOMMITTED</strong></p>\n<table>\n<thead>\n<tr>\n<th>分離レベル</th>\n<th>ダーティーリード</th>\n<th>反復不能読み取り</th>\n<th>ファントムリード</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>READ UNCOMMITTED</td>\n<td>恐れアリ</td>\n<td>恐れアリ</td>\n<td>恐れアリ</td>\n</tr>\n<tr>\n<td>READ COMMITTED</td>\n<td>発生しない</td>\n<td>恐れアリ</td>\n<td>恐れアリ</td>\n</tr>\n<tr>\n<td>REPEATABlLE READ</td>\n<td>発生しない</td>\n<td>発生しない</td>\n<td>恐れアリ</td>\n</tr>\n<tr>\n<td>SERAUZABLE</td>\n<td>発生しない</td>\n<td>発生しない</td>\n<td>発生しない</td>\n</tr>\n</tbody>\n</table>\n<h2>SELECT FOR UPDATE (行ロック)</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">BEGIN</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> 家計簿\n  <span class=\"token keyword\">WHERE</span> 日付 <span class=\"token operator\">>=</span> <span class=\"token string\">'2018-02-01'</span>\n  <span class=\"token keyword\">FOR</span> <span class=\"token keyword\">UPDATE</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">-- 明示的ロック</span>\n<span class=\"token comment\">-- 処理1</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">~</span>\n<span class=\"token comment\">-- 処理2</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">~</span>\n<span class=\"token comment\">-- 処理3</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">~</span>\n<span class=\"token keyword\">COMMIT</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">-- ロック開放</span></code></pre></div>\n<h2>LOCK TABLE (表ロック)</h2>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">BEGIN</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">LOCK</span> <span class=\"token keyword\">TABLE</span> 家計簿 <span class=\"token operator\">IN</span> EXCLUSIVE <span class=\"token keyword\">MODE</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">-- Table ロック</span>\n<span class=\"token comment\">-- 処理1</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">~</span>\n<span class=\"token comment\">-- 処理2</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">~</span>\n<span class=\"token comment\">-- 処理3</span>\n<span class=\"token keyword\">select</span> <span class=\"token operator\">~</span>\n<span class=\"token keyword\">COMMIT</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">-- ロック開放</span></code></pre></div>\n<h2>DeadLock 予防</h2>\n<ul>\n<li>トランザクションの時間を短くする</li>\n<li>同じ順番でロクする</li>\n</ul>","frontmatter":{"title":"Database Transaction","date":"February 22, 2022","post_modified":"February 22, 2022","description":"データの整合性に必要なTransactionの基本","tags":["Database","MySQL","Postgres"],"draft":false}},"previous":{"fields":{"slug":"/BackEnd/DB/SubQuery/"},"frontmatter":{"title":"Database SubQuery"}},"next":{"fields":{"slug":"/BackEnd/DB/MySQL/ MySQL_Basic/"},"frontmatter":{"title":"MySQL 基本コマンド"}}},"pageContext":{"id":"3ab79d42-7cb1-5a5c-be5f-167e44eef412","previousPostId":"1aea31b1-08b3-532d-9e6a-12307804f749","nextPostId":"0f23e7ab-668a-5441-a833-dd00036eb439","draft":false}},
    "staticQueryHashes": ["1126706167","1176493165","1188992244","1314910092","1760060771","2772418575"]}