{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/Tools/XmlLint/","result":{"data":{"site":{"siteMetadata":{"title":"おっさんWEBエンジニア奮闘記"}},"markdownRemark":{"id":"4c533a56-21af-501e-bef0-0338b89b8b6c","excerpt":"HTML HTML 内のから画像をダウンロード $target_content: HTML コンテンツ $img_dir: アウトプットパス HTML 内にがないと のエラーが出るのでで対応 Docker へ Install Alpine 系","html":"<h2>HTML</h2>\n<p>HTML 内の<code class=\"language-text\">&lt;img srs=\"xxx\"></code>から画像をダウンロード</p>\n<ul>\n<li>$target_content: HTML コンテンツ</li>\n<li>$img_dir: アウトプットパス</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"> <span class=\"token builtin class-name\">echo</span>  <span class=\"token string\">\"<span class=\"token variable\">$target_content</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n xmllint --html --xpath <span class=\"token string\">'//img/@src'</span> - <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n <span class=\"token function\">xargs</span> -n <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n <span class=\"token function\">cut</span> -d<span class=\"token operator\">=</span> -f2 <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n <span class=\"token function\">sed</span> <span class=\"token string\">'s/^\\/\\//https:\\/\\//'</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n <span class=\"token function\">xargs</span> -n <span class=\"token number\">1</span> <span class=\"token function\">curl</span> -L<span class=\"token comment\">#O --output-dir \"$img_dir\"</span></code></pre></div>\n<p>HTML 内に<code class=\"language-text\">&lt;img srs=\"xxx\"></code>がないと <code class=\"language-text\">Empty</code>のエラーが出るので<code class=\"language-text\">if</code>で対応</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span><span class=\"token string\">\"&lt;img src=\"</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token variable\">$target_content</span> <span class=\"token operator\">=~</span> <span class=\"token variable\">$key</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span>\n <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"img src in\"</span>\n <span class=\"token builtin class-name\">echo</span>  <span class=\"token string\">\"<span class=\"token variable\">$target_content</span>\"</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n xmllint --html --xpath <span class=\"token string\">'//img/@src'</span> - <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n <span class=\"token function\">xargs</span> -n <span class=\"token number\">1</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n <span class=\"token function\">cut</span> -d<span class=\"token operator\">=</span> -f2 <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n <span class=\"token function\">sed</span> <span class=\"token string\">'s/^\\/\\//https:\\/\\//'</span> <span class=\"token operator\">|</span> <span class=\"token punctuation\">\\</span>\n <span class=\"token function\">xargs</span> -n <span class=\"token number\">1</span> <span class=\"token function\">curl</span> -L<span class=\"token comment\">#O --output-dir \"$img_dir\"</span>\n<span class=\"token keyword\">else</span>\n    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"img src none\"</span>\n<span class=\"token keyword\">fi</span></code></pre></div>\n<h2>Docker へ Install</h2>\n<p>Alpine 系</p>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"><span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apk add --upgrade libxml2 libxml2-utils</span></code></pre></div>","frontmatter":{"title":"xmllint","date":"February 23, 2022","post_modified":"February 23, 2022","description":"html ファイルのスクレイピング、Dockerへインストール","tags":["Xmllint","Scraping","Docker"],"draft":false}},"previous":{"fields":{"slug":"/BackEnd/php/php_faker_basic/"},"frontmatter":{"title":"PHP faker"}},"next":{"fields":{"slug":"/Tools/vscode/snippet_variable/"},"frontmatter":{"title":"vscode で snippet"}}},"pageContext":{"id":"4c533a56-21af-501e-bef0-0338b89b8b6c","previousPostId":"c4f35a62-b1b1-5815-b8b2-1053a0b28319","nextPostId":"87c1aa9d-f6a5-566c-889a-c45664a382c0","draft":false}},"staticQueryHashes":["1126706167","1176493165","1188992244","1314910092","1760060771","2772418575","3679674316"]}