{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/Tools/ssh-login-script/",
    "result": {"data":{"site":{"siteMetadata":{"title":"おっさんWEBエンジニア奮闘記"}},"markdownRemark":{"id":"cb2ebbc1-e4b2-5700-a6bb-d23a123035af","excerpt":"ssh でのログインを快適に ssh ログインをパスワード認証ではなく鍵認証にして ~/ssh/config に の様に設定を追加して でログイン。 これはこれで大変便利なのですが、Host の数が多くなると Host 名を覚えるのが[めんどくさい]{.under_line…","html":"<h2>ssh でのログインを快適に</h2>\n<p>ssh ログインをパスワード認証ではなく鍵認証にして ~/ssh/config に</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">host</span> vagrant.local\nHostName <span class=\"token number\">192.168</span>.33.11\nUser vagrant\nPort <span class=\"token number\">22</span>\nIdentityFile ~/.ssh/id_rsa</code></pre></div>\n<p>の様に設定を追加して</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> vagrant.local</code></pre></div>\n<p>でログイン。</p>\n<p>これはこれで大変便利なのですが、Host の数が多くなると Host 名を覚えるのが[めんどくさい]{.under_line}。 記憶力との戦いになる。戦わなくていい相手。</p>\n<p>Host 一覧をプルダウンで表示させるスクリプトを考えてみた。\n(チョー簡単な内容です)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"> <span class=\"token comment\">#!/bin/bash</span>\n<span class=\"token comment\"># grep host ~/.ssh/config | awk '{print $2}'</span>\n<span class=\"token assign-left variable\">ssh_dir</span><span class=\"token operator\">=</span><span class=\"token environment constant\">$HOME</span>/.ssh\n<span class=\"token function\">chmod</span> <span class=\"token number\">700</span>  <span class=\"token variable\">$ssh_dir</span>\n<span class=\"token function\">chmod</span> <span class=\"token number\">600</span> <span class=\"token variable\">$ssh_dir</span>/*\n<span class=\"token assign-left variable\">array</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>grep ^host <span class=\"token variable\">$ssh_dir</span>/config <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'{print $2}'</span><span class=\"token punctuation\">)</span>\n<span class=\"token assign-left variable\">array_size</span><span class=\"token operator\">=</span><span class=\"token variable\">${<span class=\"token operator\">#</span>array<span class=\"token punctuation\">[</span>@<span class=\"token punctuation\">]</span>}</span>\n<span class=\"token comment\"># echo \"array size = $array_size\"</span>\n\n<span class=\"token assign-left variable\">n</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\n<span class=\"token keyword\">while</span> <span class=\"token punctuation\">[</span> <span class=\"token variable\">$n</span> -lt <span class=\"token variable\">$array_size</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">;</span><span class=\"token keyword\">do</span>\n     <span class=\"token comment\"># eval echo \"'['$n']'  ${array[$n]}\"</span>\n      <span class=\"token builtin class-name\">echo</span> -e <span class=\"token string\">$'<span class=\"token entity\" title=\"\\e\">\\e</span>[96m'</span> <span class=\"token string\">\"[<span class=\"token variable\">$n</span>] <span class=\"token variable\">${array<span class=\"token punctuation\">[</span>$n<span class=\"token punctuation\">]</span>}</span>\"</span>\n    <span class=\"token assign-left variable\">n</span><span class=\"token operator\">=</span>expr <span class=\"token variable\">$n</span> + <span class=\"token number\">1</span>\n<span class=\"token keyword\">done</span>\n\n<span class=\"token builtin class-name\">read</span> -p <span class=\"token string\">$'<span class=\"token entity\" title=\"\\e\">\\e</span>[93mEnter Number:<span class=\"token entity\" title=\"\\e\">\\e</span>[0m'</span> number\n<span class=\"token function\">ssh</span>  <span class=\"token variable\">${array<span class=\"token punctuation\">[</span>$number<span class=\"token punctuation\">]</span>}</span></code></pre></div>\n<p>を sshs (仮)で保存および実行権限付与。</p>\n<p>~/.ssh/config が下記の場合</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">host</span> aaa.com\nHostName <span class=\"token number\">192.168</span>.33.1\nUser vagrant\nPort <span class=\"token number\">22</span>\nIdentityFile ~/.ssh/id_rsa\n\n<span class=\"token function\">host</span> bbb.com\nHostName <span class=\"token number\">192.168</span>.33.2\nUser vagrant\nPort <span class=\"token number\">22</span>\nIdentityFile ~/.ssh/id_rsa\n\n<span class=\"token function\">host</span> ccc.com\nHostName <span class=\"token number\">192.168</span>.33.3\nUser vagrant\nPort <span class=\"token number\">22</span>\nIdentityFile ~/.ssh/id_rsa</code></pre></div>\n<p>sshs の実行</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">○ → sshs\n <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> aaa.com\n <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> bbb.com\n <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> ccc.com\nEnter Number:</code></pre></div>\n<p>目的の Host の番号を入力しエンター。</p>\n<p>たったこれだけですが非常に快適です。</p>","frontmatter":{"title":"sshでのログインを快適に","date":"November 02, 2019","post_modified":"November 06, 2019","description":"sshでログインの際の手続きをちょっとのスクリプトで楽をする。記憶力とは戦わない。","tags":["SSH","ShellScript"],"draft":false}},"previous":{"fields":{"slug":"/Tools/mac/karabiner/"},"frontmatter":{"title":"Karabiner"}},"next":{"fields":{"slug":"/Tools/pwgen/"},"frontmatter":{"title":"パスワード生成に便利なツール 'pwgen'"}}},"pageContext":{"id":"cb2ebbc1-e4b2-5700-a6bb-d23a123035af","previousPostId":"878b3e28-472b-5b1d-896a-b8fe1cfc0621","nextPostId":"f105acef-069d-5687-8c3e-108171a9acc3","draft":false}},
    "staticQueryHashes": ["1126706167","1176493165","1188992244","1314910092","1760060771","2772418575","3679674316"]}