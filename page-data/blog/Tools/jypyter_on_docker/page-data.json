{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blog/Tools/jypyter_on_docker/",
    "result": {"data":{"site":{"siteMetadata":{"title":"おっさんWEBエンジニア奮闘記"}},"markdownRemark":{"id":"52758661-deb9-5081-9405-b3092b8d0f7b","excerpt":"JupyterLab on Docker で PDF や Latex でダウンロードできるまで AI や機械学習で遊ぶため(お勉強)JupyterLabの環境を Docker で作りました。\nJupyterLabは動いたのですが PDF や Letax でダウンロードするにはtexlive-full…","html":"<h1>JupyterLab on Docker で PDF や Latex でダウンロードできるまで</h1>\n<p>AI や機械学習で遊ぶため(お勉強)<strong>JupyterLab</strong>の環境を Docker で作りました。\n<strong>JupyterLab</strong>は動いたのですが PDF や Letax でダウンロードするには<strong>texlive-full</strong>を追加しなければいけないことになった。</p>\n<p>しかし、<strong>texlive-full</strong>の Build(docker-composer build とか)にかなり時間がかかりました。(30 分超)\n最初の一回だけならいいのですが Python のライブラリを追加した場合などは再 Build することになります。</p>\n<p>再 Build の度に 30 分超の時間は[めんどくさい]{.under_line}ので<strong>texlive-full</strong>のインストールを<strong>Dockerfile</strong>ではなく<strong>DockerImage</strong>内でインストールしておく**\nDockerImage<strong>を作成。<br>\n作成した</strong>DockerImage**を<a href=\"https://cloud.docker.com/repository/docker/webdimension/jupyter-latex\">DockerHub</a>{target=“_blank”\nrel=“noopener noreferrer”}へ、Source を<a href=\"https://gitlab.com/webdimension/python\">GitLab</a>{target=“_blank” rel=“noopener\nnoreferrer”}へ登録しました。</p>\n<h2>既存の DockerImage から JupyterLab を構築</h2>\n<p>ネットからほぼコピペの Dockerfile だと</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">FROM python:3.7.3-slim-stretch\n\nENV PYTHONPATH <span class=\"token string\">\"/opt/python/library\"</span>\n\nCOPY requirements.txt /tmp/requirements.txt\n\nRUN <span class=\"token function\">apt-get</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">apt-get</span> -y upgrade\n\nRUN <span class=\"token builtin class-name\">set</span> -x <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    pip <span class=\"token function\">install</span> -U pip <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    pip <span class=\"token function\">install</span> -r /tmp/requirements.txt <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/library <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/jupyter <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/jupyterlab <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> ~/.jupyter <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> ~/.src <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">rm</span> /tmp/requirements.txt\n\nCOPY jupyter/jupyter_notebook_config.py /root/.jupyter/jupyter_notebook_config.py\n\nRUN jupyter labextension <span class=\"token function\">install</span> jupyterlab_vim <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> @jupyter-widgets/jupyterlab-manager <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> @jupyterlab/toc <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> jupyterlab-favorites <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> jupyterlab-recents\n\nEXPOSE <span class=\"token number\">8888</span>\nCMD <span class=\"token punctuation\">[</span><span class=\"token string\">\"jupyter\"</span>, <span class=\"token string\">\"lab\"</span>, <span class=\"token string\">\"--allow-root\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>これでも<strong>JupyteLab</strong>自体動作しますがメニューの\n“File -> Export Nootebook as “から PDF や Latex でダウンロードしようとするとエラーが発生。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d1e5be3455166151eebcb5d322954346/142fb/Screen-Shot-2019-11-02-at-16.20.03.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.075949367088604%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0klEQVQoz61QvQqDYAzs+7+Eg4ugKA4KTg4u4gOooIN/iLNW6w965SK2m10aOJIvOZK773EcB+7jwGt8Yp4X/AruerBIkgRhGCLLMozjiDiOkec5yrJEVVWS0zQVXl3XaJpGEEURiqIQzrKcB2VhEATQNA2+76PrOliWBVVV4TgOTNOEYRjCURQFnudB13VZZts2XNcVPoXIwjvLnPF627aisu/735a3bfvYoh3WBC1dfda0xsz3xSXYZx6G4VS477vInabpFnccztZ1/f7hv4KW34abDzDL5FhPAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2019 11 02 at 16 20 03\"\n        title=\"Screen Shot 2019 11 02 at 16 20 03\"\n        src=\"/static/d1e5be3455166151eebcb5d322954346/f058b/Screen-Shot-2019-11-02-at-16.20.03.png\"\n        srcset=\"/static/d1e5be3455166151eebcb5d322954346/c26ae/Screen-Shot-2019-11-02-at-16.20.03.png 158w,\n/static/d1e5be3455166151eebcb5d322954346/6bdcf/Screen-Shot-2019-11-02-at-16.20.03.png 315w,\n/static/d1e5be3455166151eebcb5d322954346/f058b/Screen-Shot-2019-11-02-at-16.20.03.png 630w,\n/static/d1e5be3455166151eebcb5d322954346/142fb/Screen-Shot-2019-11-02-at-16.20.03.png 907w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>調べたところ<strong>texlive-full</strong>をインストールすれば解決するらしい。\n<strong>texlive-full</strong>のインストールを追記した<strong>Dockerfile</strong>が以下。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">FROM python:3.7.3-slim-stretch\n\nENV PYTHONPATH <span class=\"token string\">\"/opt/python/library\"</span>\n\nCOPY requirements.txt /tmp/requirements.txt\n\nRUN <span class=\"token function\">apt-get</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">apt-get</span> -y upgrade\nRUN <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">curl</span> <span class=\"token punctuation\">\\</span>\n    gnupg <span class=\"token punctuation\">\\</span>\n    pandoc\nRUN <span class=\"token function\">curl</span> -sL https://deb.nodesource.com/setup_11.x <span class=\"token operator\">|</span> <span class=\"token function\">bash</span> -\nRUN <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y nodejs\nRUN <span class=\"token function\">npm</span> <span class=\"token function\">install</span> npm@latest -g\n\nRUN <span class=\"token builtin class-name\">set</span> -x <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    pip <span class=\"token function\">install</span> -U pip <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    pip <span class=\"token function\">install</span> -r /tmp/requirements.txt <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/library <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/jupyter <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/jupyterlab <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> ~/.jupyter <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> ~/.src <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">rm</span> /tmp/requirements.txt\n\nCOPY jupyter/jupyter_notebook_config.py /root/.jupyter/jupyter_notebook_config.py\n\nRUN jupyter labextension <span class=\"token function\">install</span> jupyterlab_vim <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> @jupyter-widgets/jupyterlab-manager <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> @jupyterlab/toc <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> jupyterlab-favorites <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> jupyterlab-recents\n\nEXPOSE <span class=\"token number\">8888</span>\n\nADD xelatex/packages.txt <span class=\"token builtin class-name\">.</span>\nRUN <span class=\"token function\">apt-get</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Install packages</span>\n    <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">cat</span> packages.txt<span class=\"token variable\">)</span></span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Removing documentation packages *after* installing them is kind of hacky,</span>\n    <span class=\"token function\">apt-get</span> --purge remove -y .<span class=\"token punctuation\">\\</span>*-doc$ <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Remove more unnecessary stuff</span>\n    <span class=\"token function\">apt-get</span> clean -y <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Create directory for iso690</span>\n    <span class=\"token function\">mkdir</span> -p <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>kpsewhich -var-value TEXMFHOME<span class=\"token variable\">)</span></span>\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Change directory</span>\n    <span class=\"token builtin class-name\">cd</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>kpsewhich -var-value TEXMFHOME<span class=\"token variable\">)</span></span>\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Clone repository</span>\n    <span class=\"token function\">git</span> clone https://github.com/michal-h21/biblatex-iso690.git <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Run texhash</span>\n    texhash\nCMD <span class=\"token punctuation\">[</span><span class=\"token string\">\"jupyter\"</span>, <span class=\"token string\">\"lab\"</span>, <span class=\"token string\">\"--allow-root\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>これで PDF や Latex でダウンロードできるようになりました。しかし build にかなり時間がかかります。(30 分超)。 最初の一回だけならまだいいのですがこの Dockerfile だと</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">COPY requirements.txt /tmp/requirements.txt\n<span class=\"token punctuation\">..</span>.\n<span class=\"token punctuation\">..</span>.\npip <span class=\"token function\">install</span> -r /tmp/requirements.txt <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span></code></pre></div>\n<p>この部分で python のパッケージを pip でインストールしています。\n<strong>pandas</strong>などのパッケージを追加する場合は requirements.txt に<strong>pandas</strong>を追記して build するようになります。 このままだとライブラリを追加する度に 30 分以上かかり[めんどくさい]\n{.under_line}ので Dockerfile は最小限にして<strong>JupyterLab</strong>,<strong>texlive-full</strong>のインストールは DockerImage 側でするような DockerImage を用意します。</p>\n<h2>JupyterLab,exlive-full 環境構築のための DockerFile</h2>\n<p>DockerImage を作るための Dockerfile です。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">FROM python:3.7.3-slim-stretch\n\nRUN <span class=\"token function\">apt-get</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">apt-get</span> -y upgrade\nRUN <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">curl</span> <span class=\"token punctuation\">\\</span>\n    gnupg <span class=\"token punctuation\">\\</span>\n    pandoc\n\nRUN <span class=\"token function\">curl</span> -sL https://deb.nodesource.com/setup_11.x <span class=\"token operator\">|</span> <span class=\"token function\">bash</span> -\nRUN <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y nodejs\nRUN <span class=\"token function\">npm</span> <span class=\"token function\">install</span> npm@latest -g\n\nRUN <span class=\"token builtin class-name\">set</span> -x <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    pip <span class=\"token function\">install</span> -U pip <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    pip <span class=\"token function\">install</span> jupyterlab\n\nRUN jupyter labextension <span class=\"token function\">install</span> jupyterlab_vim <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> @jupyter-widgets/jupyterlab-manager <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> @jupyterlab/toc <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> jupyterlab-favorites <span class=\"token punctuation\">\\</span>\n      <span class=\"token operator\">&amp;&amp;</span> jupyter labextension <span class=\"token function\">install</span> jupyterlab-recents\n\nADD xelatex/packages.txt <span class=\"token builtin class-name\">.</span>\nRUN <span class=\"token function\">apt-get</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Install packages</span>\n    <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">cat</span> packages.txt<span class=\"token variable\">)</span></span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Removing documentation packages *after* installing them is kind of hacky,</span>\n    <span class=\"token function\">apt-get</span> --purge remove -y .<span class=\"token punctuation\">\\</span>*-doc$ <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Remove more unnecessary stuff</span>\n    <span class=\"token function\">apt-get</span> clean -y <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Create directory for iso690</span>\n    <span class=\"token function\">mkdir</span> -p <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>kpsewhich -var-value TEXMFHOME<span class=\"token variable\">)</span></span>\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Change directory</span>\n    <span class=\"token builtin class-name\">cd</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span>kpsewhich -var-value TEXMFHOME<span class=\"token variable\">)</span></span>\"</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Clone repository</span>\n    <span class=\"token function\">git</span> clone https://github.com/michal-h21/biblatex-iso690.git <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token comment\"># Run texhash</span>\n    texhash</code></pre></div>\n<p>docker-composer.yml</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">version: <span class=\"token string\">'3'</span>\n\nservices:\n  jupyterlab:\n    build: jupyterlab\n    hostname: jupyterlab\n    container_name: jupyterlab</code></pre></div>\n<p>この Dockerfile では</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">pip <span class=\"token function\">install</span> jupyterlab\n<span class=\"token punctuation\">..</span>.\nRUN jupyter labextension <span class=\"token function\">install</span> jupyterlab_vim\n<span class=\"token punctuation\">..</span>.\n<span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">cat</span> packages.txt<span class=\"token variable\">)</span></span></code></pre></div>\n<ul>\n<li>Python パッケージは<strong>JupyterLab</strong>のみインストール</li>\n<li><strong>JupyterLab</strong>拡張機能のインストール</li>\n<li>*texlive-full**</li>\n</ul>\n<p>となってます。</p>\n<h2>DockerImage を生成し DockerHub へアップロード</h2>\n<ul>\n<li>DcokerHub でアカウント登録</li>\n<li>DockerHub でリポジトリの作成 上記が前提です。<a href=\"https://hub.docker.com/\">Docker Hub</a>{target=“_brank” rel=“noopener noreferrer”}</li>\n</ul>\n<p>DockerImage を生成</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token variable\">$docker</span>-compose build</code></pre></div>\n<p>時間がかかります。 … 生成された DockerImage を確認</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token variable\">$docker</span> images</code></pre></div>\n<p>生成された<strong>DckerImage</strong>を確認できるかと思います。 生成された<strong>DockerImage</strong>を<strong>DockerHub</strong>へ Push します。 まずは DockerHub へログイン</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">docker</span> login\n<span class=\"token comment\"># パスワードを入力してログイン</span></code></pre></div>\n<p>新規<strong>DockerImage</strong>を Commit</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token variable\">$docker</span> commit -a <span class=\"token string\">\"webdimension\"</span> -m <span class=\"token string\">\"jupyterlab and latex\"</span> jupyterlab webdimension/jupyter-latex\n<span class=\"token comment\"># docker commit -a \"作者名\" -m \"コメント\" 対象のイメージ名 DockerHubアカウント名/リポジトリ名</span></code></pre></div>\n<p>新規<strong>DockerImage</strong>をリポジトリへ Push</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token variable\">$docker</span> push webdimension/jupyter-latex\n<span class=\"token comment\"># docker push DockerHubアカウント名/jupyter-リポジトリ名</span></code></pre></div>\n<p>これまた時間がかかります。。。。 無事 Push が完了すれば<a href=\"https://cloud.docker.com/repository/list\">DockerHub のレポジトリ</a>{target=“_brank” rel=”\nnoopener noreferrer”}でも確認してみます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/57b4d561858703b0c575d433907eeac7/b97f6/Screen-Shot-2019-11-03-at-11.45.33.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.0126582278481%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA40lEQVQY032PyU7DMBRF821AJWa2rPm2FFIWLPgoFkiJ0ziJp/d8kBNBVRW40tn4Dtarnt57Ht8M9zvDZttxXp9yVndcvRhuGsPdznDbGK4bw8Or4fK5vHds6paLuqVqreOzn3BRiJJP0ZUgGZ8OhJRxSZfM5CPt3jLOjioGzzyNjKNFRSBnVJUUI8F7vHeE4MkqrMr8pQ8rVCKC94GYEjnnH0SU4hVCGY8R1eJxlPumaI65DOoSLsVSENWFNbj+nESIS0Z/HTuMZqoSLrcPdmScZsx+oB/sUXlefItzfj36n9EvNsHDelYKdEsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screen Shot 2019 11 03 at 11 45 33\"\n        title=\"Screen Shot 2019 11 03 at 11 45 33\"\n        src=\"/static/57b4d561858703b0c575d433907eeac7/f058b/Screen-Shot-2019-11-03-at-11.45.33.png\"\n        srcset=\"/static/57b4d561858703b0c575d433907eeac7/c26ae/Screen-Shot-2019-11-03-at-11.45.33.png 158w,\n/static/57b4d561858703b0c575d433907eeac7/6bdcf/Screen-Shot-2019-11-03-at-11.45.33.png 315w,\n/static/57b4d561858703b0c575d433907eeac7/f058b/Screen-Shot-2019-11-03-at-11.45.33.png 630w,\n/static/57b4d561858703b0c575d433907eeac7/40601/Screen-Shot-2019-11-03-at-11.45.33.png 945w,\n/static/57b4d561858703b0c575d433907eeac7/b97f6/Screen-Shot-2019-11-03-at-11.45.33.png 958w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>これで新規 DockerImage を DockerHub へ登録できました。</p>\n<h2>DockerHub へ登録した DockerImage から JupyterLab 環境を構築</h2>\n<p>docker-compose.yml</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">version: <span class=\"token string\">'3'</span>\n\nservices:\n  jupyterlab:\n    build: jupyterlab\n    hostname: jupyterlab\n    container_name: jupyterlab\n    ports:\n      - <span class=\"token string\">\"8888:8888\"</span>\n    volumes:\n      - <span class=\"token punctuation\">..</span>/src:/opt/python/src\n      - <span class=\"token punctuation\">..</span>/jupyter:/opt/python/jupyter\n      - ./jupyterlab:/opt/python/jupyterlab\n      - ./jupyterlab/library:/opt/python/librar</code></pre></div>\n<p>Dockerfile</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">FROM webdimension/jupyter-latex\nENV PYTHONPATH <span class=\"token string\">\"/opt/python/library\"</span>\nCOPY requirements.txt /tmp/requirements.txt\n\nRUN <span class=\"token builtin class-name\">set</span> -x <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    pip <span class=\"token function\">install</span> -U pip <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    pip <span class=\"token function\">install</span> -r /tmp/requirements.txt <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/jupyter <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/src <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/library <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> -p /opt/python/jupyterlab <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">mkdir</span> ~/.jupyter <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token function\">rm</span> /tmp/requirements.txt\n\nCOPY jupyter_notebook_config.py /root/.jupyter/jupyter_notebook_config.py\n\nEXPOSE <span class=\"token number\">8888</span>\nCMD <span class=\"token punctuation\">[</span><span class=\"token string\">\"jupyter\"</span>, <span class=\"token string\">\"lab\"</span>, <span class=\"token string\">\"--allow-root\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Build は</p>\n<ul>\n<li>Python パッケージのインストール</li>\n<li>JupyterLab の設定</li>\n</ul>\n<p>とシンプルになりと Build 時間も数秒になりました。</p>","frontmatter":{"title":"JupyterLab on Docker でPDFやLatexでダウンロードできるまで","date":"November 03, 2019","post_modified":"November 03, 2019","description":"既存のDockerイメージ(python:3.7.3-slim-stretch)にtexlive-fullをインストールしDockerHubへPushするまで。","tags":["Docker","Python","Jupyter"],"draft":false}},"previous":{"fields":{"slug":"/Tools/pwgen/"},"frontmatter":{"title":"パスワード生成に便利なツール 'pwgen'"}},"next":{"fields":{"slug":"/BackEnd/php/laravel/laravel-preparation-01/"},"frontmatter":{"title":"Laravelでの開発の前準備その１"}}},"pageContext":{"id":"52758661-deb9-5081-9405-b3092b8d0f7b","previousPostId":"6bb92111-e7cd-5700-b822-486a5c14f5c2","nextPostId":"83888706-a7b6-55ea-9c71-867ee5e6a864","draft":false}},
    "staticQueryHashes": ["1126706167","1176493165","1188992244","1314910092","2772418575"]}